<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Joachim Wiberg ">
<meta name="description" content="This is an SNMP server for small and embedded systems, currently Linux and FreeBSD are supported. It is easily portable to other UNIX systems since it&amp;rsquo;s written in C. The daemon is very small (~40 kiB) and does not have nowhere near the feature set of Net-SNMP, therefore it has a very low impact on system resources.
See my mini HowTo: Playing with SNMP for a quick introduction to setting up the SNMP tools and MIBs to avoid having to use numerical OIDs." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://troglobit.com/projects/mini-snmpd/" />


    <title>
        
            Mini SNMP daemon :: Joachim Wiberg  — The Last Outpost
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://troglobit.com/main.de188b3201233c251f4fd6306dbd2cb41e408fb8846c09781b2925de7df5025c.css">


    
        <link rel="stylesheet" type="text/css" href="https://troglobit.com/css/extra.css">
    



    <link rel="apple-touch-icon" sizes="180x180" href="https://troglobit.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://troglobit.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://troglobit.com/favicon-16x16.png">
    <link rel="manifest" href="https://troglobit.com/site.webmanifest">
    <link rel="mask-icon" href="https://troglobit.com/safari-pinned-tab.svg" color="#1b1c1d">
    <link rel="shortcut icon" href="https://troglobit.com/favicon.ico">
    <meta name="msapplication-TileColor" content="#1b1c1d">
    <meta name="theme-color" content="#1b1c1d">



<meta itemprop="name" content="Mini SNMP daemon">
<meta itemprop="description" content="This is an SNMP server for small and embedded systems, currently Linux and FreeBSD are supported. It is easily portable to other UNIX systems since it&rsquo;s written in C. The daemon is very small (~40 kiB) and does not have nowhere near the feature set of Net-SNMP, therefore it has a very low impact on system resources.
See my mini HowTo: Playing with SNMP for a quick introduction to setting up the SNMP tools and MIBs to avoid having to use numerical OIDs.">
<meta itemprop="datePublished" content="2020-02-23T09:00:00&#43;02:00" />
<meta itemprop="dateModified" content="2020-02-23T09:00:00&#43;02:00" />
<meta itemprop="wordCount" content="956">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Mini SNMP daemon"/>
<meta name="twitter:description" content="This is an SNMP server for small and embedded systems, currently Linux and FreeBSD are supported. It is easily portable to other UNIX systems since it&rsquo;s written in C. The daemon is very small (~40 kiB) and does not have nowhere near the feature set of Net-SNMP, therefore it has a very low impact on system resources.
See my mini HowTo: Playing with SNMP for a quick introduction to setting up the SNMP tools and MIBs to avoid having to use numerical OIDs."/>




    <meta property="og:title" content="Mini SNMP daemon" />
<meta property="og:description" content="This is an SNMP server for small and embedded systems, currently Linux and FreeBSD are supported. It is easily portable to other UNIX systems since it&rsquo;s written in C. The daemon is very small (~40 kiB) and does not have nowhere near the feature set of Net-SNMP, therefore it has a very low impact on system resources.
See my mini HowTo: Playing with SNMP for a quick introduction to setting up the SNMP tools and MIBs to avoid having to use numerical OIDs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://troglobit.com/projects/mini-snmpd/" />
<meta property="article:published_time" content="2020-02-23T09:00:00+02:00" />
<meta property="article:modified_time" content="2020-02-23T09:00:00+02:00" />






    <meta property="article:published_time" content="2020-02-23 09:00:00 &#43;0200 &#43;0200" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://troglobit.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://troglobit.com/about/">About</a></li><li><a href="https://troglobit.com/posts/">Blog</a></li><li><a href="https://troglobit.com/howtos/">HowTos</a></li><li><a href="https://troglobit.com/projects/">Projects</a></li><li><a href="https://resume.troglobit.com">Resumé</a></li><li><a href="https://ftp.troglobit.com">FTP</a></li><li><a href="https://deb.troglobit.com">DEB</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://troglobit.com/projects/mini-snmpd/">Mini SNMP daemon</a></h2>

            
            
            

            <div class="post-content">
                <p>This is an SNMP server for small and embedded systems, currently Linux
and FreeBSD are supported.  It is easily portable to other UNIX systems
since it&rsquo;s written in C.  The daemon is very small (~40 kiB) and does
not have nowhere near the feature set of <a href="http://net-snmp.org">Net-SNMP</a>, therefore it has
a very low impact on system resources.</p>
<p>See my mini HowTo: <a href="https://troglobit.com/howto-play-with-snmp.html">Playing with SNMP</a> for a
quick introduction to setting up the SNMP tools and MIBs to avoid having
to use numerical OIDs.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Supports SNMP version 1 and 2c</li>
<li>Supports SNMP <code>get</code>, <code>getnext</code> and <code>getbulk</code></li>
<li>Supports both IPv4 and IPv6</li>
<li>Supports communication over UDP and TCP sockets</li>
<li>Supports the most important performance data (uptime, CPU load, memory usage)</li>
<li>Supports the most important network data (bytes/packets in/out, error counts)</li>
<li>Supports the most important disk data (disk space/inodes available/used/free)</li>
<li>Tested with <a href="http://net-snmp.org">net-snmp</a>, <a href="http://net-snmp.net">cacti</a>, and <a href="http://oss.oetiker.ch/mrtg/">MRTG</a></li>
</ul>
<p><a id="example"></a></p>
<h2 id="example">Example</h2>
<p>First start the daemon:</p>
<pre><code>$ sudo ./mini-snmpd -i eth0,eth1,wlan0
</code></pre>
<p>Then do an SNMP walk:</p>
<pre><code>$ snmpwalk -v2c -c public 127.0.0.1 .
SNMPv2-MIB::sysDescr.0 = STRING: 
SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises
SNMPv2-MIB::sysUpTime.0 = Timeticks: (5954) 0:00:59.54
SNMPv2-MIB::sysContact.0 = STRING: 
SNMPv2-MIB::sysName.0 = STRING: luthien
SNMPv2-MIB::sysLocation.0 = STRING: 
IF-MIB::ifNumber.0 = INTEGER: 3
IF-MIB::ifIndex.1 = INTEGER: 1
IF-MIB::ifIndex.2 = INTEGER: 2
IF-MIB::ifIndex.3 = INTEGER: 3
IF-MIB::ifDescr.1 = STRING: eth0
IF-MIB::ifDescr.2 = STRING: eth1
IF-MIB::ifDescr.3 = STRING: wlan0
IF-MIB::ifOperStatus.1 = INTEGER: up(1)
IF-MIB::ifOperStatus.2 = INTEGER: lowerLayerDown(7)
IF-MIB::ifOperStatus.3 = INTEGER: up(1)
IF-MIB::ifInOctets.1 = Counter32: 1791842
IF-MIB::ifInOctets.2 = Counter32: 0
IF-MIB::ifInOctets.3 = Counter32: 1909293573
IF-MIB::ifInUcastPkts.1 = Counter32: 18071
IF-MIB::ifInUcastPkts.2 = Counter32: 0
IF-MIB::ifInUcastPkts.3 = Counter32: 2010670
IF-MIB::ifInDiscards.1 = Counter32: 12
IF-MIB::ifInDiscards.2 = Counter32: 0
IF-MIB::ifInDiscards.3 = Counter32: 0
IF-MIB::ifInErrors.1 = Counter32: 0
IF-MIB::ifInErrors.2 = Counter32: 0
IF-MIB::ifInErrors.3 = Counter32: 0
IF-MIB::ifOutOctets.1 = Counter32: 1199703
IF-MIB::ifOutOctets.2 = Counter32: 0
IF-MIB::ifOutOctets.3 = Counter32: 179994204
IF-MIB::ifOutUcastPkts.1 = Counter32: 6437
IF-MIB::ifOutUcastPkts.2 = Counter32: 0
IF-MIB::ifOutUcastPkts.3 = Counter32: 1269885
IF-MIB::ifOutDiscards.1 = Counter32: 0
IF-MIB::ifOutDiscards.2 = Counter32: 0
IF-MIB::ifOutDiscards.3 = Counter32: 0
IF-MIB::ifOutErrors.1 = Counter32: 0
IF-MIB::ifOutErrors.2 = Counter32: 0
IF-MIB::ifOutErrors.3 = Counter32: 0
HOST-RESOURCES-MIB::hrSystemUptime.0 = Timeticks: (4290528121) 496 days, 14:08:01.21
UCD-SNMP-MIB::memTotalReal.0 = INTEGER: 8055412 kB
UCD-SNMP-MIB::memAvailReal.0 = INTEGER: 961136 kB
UCD-SNMP-MIB::memShared.0 = INTEGER: 0 kB
UCD-SNMP-MIB::memBuffer.0 = INTEGER: 474372 kB
UCD-SNMP-MIB::memCached.0 = INTEGER: 2473876 kB
UCD-SNMP-MIB::dskIndex.1 = INTEGER: 1
UCD-SNMP-MIB::dskPath.1 = STRING: /
UCD-SNMP-MIB::dskTotal.1 = INTEGER: 222230176
UCD-SNMP-MIB::dskAvail.1 = INTEGER: 20289308
UCD-SNMP-MIB::dskUsed.1 = INTEGER: 201940864
UCD-SNMP-MIB::dskPercent.1 = INTEGER: 91
UCD-SNMP-MIB::dskPercentNode.1 = INTEGER: 12
UCD-SNMP-MIB::laIndex.1 = INTEGER: 1
UCD-SNMP-MIB::laIndex.2 = INTEGER: 2
UCD-SNMP-MIB::laIndex.3 = INTEGER: 3
UCD-SNMP-MIB::laNames.1 = STRING: Load-1
UCD-SNMP-MIB::laNames.2 = STRING: Load-5
UCD-SNMP-MIB::laNames.3 = STRING: Load-15
UCD-SNMP-MIB::laLoad.1 = STRING: 0.06
UCD-SNMP-MIB::laLoad.2 = STRING: 0.14
UCD-SNMP-MIB::laLoad.3 = STRING: 0.28
UCD-SNMP-MIB::laConfig.1 = STRING: 1
UCD-SNMP-MIB::laConfig.2 = STRING: 5
UCD-SNMP-MIB::laConfig.3 = STRING: 15
UCD-SNMP-MIB::laLoadInt.1 = INTEGER: 6
UCD-SNMP-MIB::laLoadInt.2 = INTEGER: 14
UCD-SNMP-MIB::laLoadInt.3 = INTEGER: 28
UCD-SNMP-MIB::ssCpuRawUser.0 = Counter32: 2263123
UCD-SNMP-MIB::ssCpuRawNice.0 = Counter32: 8820
UCD-SNMP-MIB::ssCpuRawSystem.0 = Counter32: 353194
UCD-SNMP-MIB::ssCpuRawIdle.0 = Counter32: 46493489
UCD-SNMP-MIB::ssRawInterrupts.0 = Counter32: 50186444
UCD-SNMP-MIB::ssRawContexts.0 = Counter32: 243678129
UCD-SNMP-MIB::ssRawContexts.0 = No more variables left in this MIB View (It is past the end of the MIB tree)
</code></pre>
<p><a id="small"></a></p>
<h2 id="building-really-small-binaries">Building Really Small Binaries</h2>
<p>By simply calling <code>./configure &amp;&amp; make</code> you don&rsquo;t really get a small
mini-snmpd binary.  Sure, most people know about setting <code>CFLAGS=-Os</code>
before calling the configure script &ndash; that&rsquo;s how you reach the ~40 kiB
mentioned above.</p>
<pre><code>CFLAGS=&quot;-Os&quot; ./configure &amp;&amp; make clean all &amp;&amp; strip mini-snmpd &amp;&amp; ll mini-snmpd &amp;&amp; size mini-snmpd
-rwxrwxr-x 1 jocke jocke 39520 nov  8 21:35 mini-snmpd*
   text	   data	    bss	    dec	    hex	 filename
  32766	   1028	  16032	  49826	   c2a2	 mini-snmpd
</code></pre>
<p>To get really crazy with things you can try this, it works for me but
YMMV as usual:</p>
<pre><code>CFLAGS=&quot;-W -Wall -Os -U_FORTIFY_SOURCE -fno-stack-protector -fomit-frame-pointer -ffunction-sections -fdata-sections -Wl,--gc-sections -fno-asynchronous-unwind-tables -fmerge-all-constants -fno-ident -Wl,-z,norelro -Wl,--hash-style=gnu -Wl,--build-id=none &quot; ./configure --disable-ipv6
make clean all &amp;&amp; strip -S --strip-unneeded --remove-section=.note.gnu.gold-version --remove-section=.comment --remove-section=.note --remove-section=.note.gnu.build-id --remove-section=.note.ABI-tag mini-snmpd &amp;&amp; ll mini-snmpd &amp;&amp; size mini-snmpd
-rwxrwxr-x 1 jocke jocke 30696 nov  8 21:37 mini-snmpd*
   text	   data	    bss	    dec	    hex	 filename
  27305	    964	  15968	  44237	   accd	 mini-snmpd
</code></pre>
<p>This insane amount of arguments to GCC saves you ~9kiB.  Which begs the
question, is there anything else you can do, how low can we go?!  Let me
introduce you to <a href="http://upx.sourceforge.net/">upx</a>:</p>
<pre><code>upx --ultra-brute mini-snmpd &amp;&amp; ll mini-snmpd &amp;&amp; size mini-snmpd
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2013
UPX 3.91        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Sep 30th 2013

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
     30696 -&gt;     15604   50.83%  linux/ElfAMD   mini-snmpd

Packed 1 file.
-rwxrwxr-x 1 jocke jocke 15604 nov  8 21:37 mini-snmpd*
   text	   data	    bss	    dec	    hex	 filename
      0	      0	      0	      0	      0	 mini-snmpd
</code></pre>
<p>Yeah, running <code>size</code> on the binary afterwards is kinda useless, but
<em>WOW</em>!  Using upx actually cut the size down to almost half of what we
got with the insane arguments above &ndash; saved ~15kiB on a 30kiB binary!</p>
<p>On embedded targets some of these tricks may just about save you if
you&rsquo;re running out of flash.  However, there are often nasty compiler
bugs to be found just by changing optimization level to <code>-Os</code>.  So when
it comes to embedded I always recommend playing it safe and going with
<code>-O2</code> and no further optimizations, unless you want to spend a lot of
time looking for weird bugs!</p>
<p><a id="info"></a></p>
<h2 id="project-info">Project Info</h2>
<p>This is the continuation of the hard work on mini-snmpd by Robert Ernst.
Unfortunately his <a href="https://web.archive.org/web/20150522170054/http://members.aon.at/linuxfreak/linux/mini_snmpd.html">mini-snmpd homepage</a> has gone offline, so that and
the lack of updates over the last couple of years is what prompted my
setting up a <a href="http://github.com/troglobit/mini-snmpd">GitHub project</a> to act as a focal point for future
development.  I&rsquo;ve also taken the liberty of setting up an
<a href="ftp://ftp.troglobit.com/mini-snmpd/">FTP mirror</a> of any previous releases I could find.  If you happen
to come by any older version(s), send me an email! :)</p>
<p>mini-snmpd is licensed under the <a href="https://github.com/troglobit/mini-snmpd/blob/master/COPYING">GNU GPL v2</a>.</p>
<ul>
<li><a href="http://github.com/troglobit/mini-snmpd">Repository</a></li>
<li><a href="http://github.com/troglobit/mini-snmpd/issues">Issue Tracker</a></li>
<li><a href="ftp://ftp.troglobit.com/mini-snmpd/mini-snmpd-1.6.tar.gz">mini-snmpd-1.6.tar.gz</a>,
<a href="ftp://ftp.troglobit.com/mini-snmpd/mini-snmpd-1.6.tar.gz.md5">MD5</a>,</li>
<li><a href="https://github.com/troglobit/mini-snmpd/releases/tag/v1.6">ChangeLog</a></li>
<li><a href="https://github.com/troglobit/mini-snmpd/blob/master/TODO">TODO</a></li>
<li>Man page <a href="http://ftp.troglobit.com/mini-snmpd/mini-snmpd.html">mini-snmpd.8</a> (outdated)</li>
</ul>
<p>See also the old <a href="http://freecode.com/projects/minisnmpd">Free(code) page</a>.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="https://troglobit.com/">Joachim Wiberg</a></span>
            <span>UNIX&trade; 4Life! &#9994;</span><span><a href="https://troglobit.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="https://troglobit.com/bundle.min.af435e44374f1e99a669ea8cd5bb9a2fceed80588941a451bfddb66b86a67c9f40b0f417e9543a763f809aa7e9300d7b1d69bf99615810ba02ac70396d50fad5.js" integrity="sha512-r0NeRDdPHpmmaeqM1buaL87tgFiJQaRRv922a4amfJ9AsPQX6VQ6dj&#43;AmqfpMA17HWm/mWFYELoCrHA5bVD61Q=="></script>



    </body>
</html>

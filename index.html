
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Troglobit</title>
  <meta name="author" content="Joachim Nilsson">

  
  <meta name="description" content="So you&rsquo;re having a problem with the Internet daemon you wrote. You&rsquo;re
convinced the firewall, or some other magic, in your modern Linux &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://troglobit.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Troglobit" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/favicon.png" rel="icon">
<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Troglobit</a></h1>
  
    <h2>Help me Obi-Wan Troglobi, you&#8217;re my only hope!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="troglobit.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="http://resume.troglobit.com">Resume</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="http://git.troglobit.com">GIT</a></li>
  <li><a href="/finit.html">Finit</a></li>
  <li><a href="/inadyn.html">Inadyn</a></li>
  <li><a href="/smcroute.html">SMCRoute</a></li>
  <li><a href="/mrouted.html">mrouted</a></li>
  <li><a href="/pimd.html">pimd</a></li>
  <li><a href="/uftpd.html">uftpd</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/21/using-netcat-to-test-your-internet-daemon/">Using Netcat to Test Your Internet Daemon</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-21T14:21:49+02:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>2:21 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So you&rsquo;re having a problem with the Internet daemon you wrote.  You&rsquo;re
convinced the firewall, or some other magic, in your modern Linux
distribution is eating your packets.</p>

<p>No.</p>

<p>First, make sure your daemon is actually running and has successfully
bound to the address and port in question:</p>

<pre><code>sudo netstat -atnup
</code></pre>

<p>If your application is not listed there you have a problem with it
binding its server socket.  Check the return values from <code>bind()</code>.</p>

<p>If you&rsquo;re still suspecting the firewall, or some other magic, test your
theory with netcat.  First start a server, with your relevant address
and port, remember you need to be root, or have <code>CAP_NET_ADMIN</code>, to use
ports &lt;= 4096:</p>

<pre><code>nc -l -u -p 9999
</code></pre>

<p>Here we bind to 0.0.0.0:9999. Now, start a client to test if the
server can receive any data:</p>

<pre><code>nc -u 127.0.0.1 9999
</code></pre>

<p>Type something on the console and press enter to send it to the server.
If you receive the data then there&rsquo;s no magic, execpt from bugs in you
application, preventing your appplication from working.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/11/the-key-to-successful-boot/">The Key to Successful Boot</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-11T01:28:27+02:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:28 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>How do you know when your UNIX service (daemon) is ready?  Simple, it
has created a PID file, signalling to you how to reach it.  Usually this
file is created as <code>/var/run/daemon.pid</code>, or <code>/run/daemon.pid</code>, and has
the PID of <code>daemon</code> as the first and only data in the file.  This data
may or may not have a UNIX line ending.</p>

<p>Only trouble is: most UNIX daemons do not re-assert that PID file
properly on <code>SIGHUP</code> (if they support <code>SIGHUP</code> that is).  When I send
<code>SIGHUP</code> to a daemon I expect it to re-read its <code>/etc/daemon.conf</code> and
resume operation, basically a quicker way than stop/start.</p>

<p>Annoyingly however, most daemons do not signal us back to tell us when
they&rsquo;re done with the <code>SIGHUP</code>.  Naturally a new movement has risen that
says we should all instrument our daemons with D-bus &hellip; I say no.
Simply touch the PID file instead.</p>

<p>Yeah, one could argue the natural (and pure) thing would be to add a
UNIX domain socket and use a <code>daemonctl</code> client instead of <code>SIGHUP</code> +
PID file &hellip; but for this little mechanism of signalling back to the
user that a daemon is ready for business, it&rsquo;s too much overhead.</p>

<p>My own Init replacement, <a href="/finit.html">Finit</a>, is being fitted with a
system to synchronize services with events.  Eg. wait for one service to
start, an interface to be created, or come up, or have an address set,
or a gateway to be set &hellip; and so on.</p>

<p>In the case where process B depends on process A you do not want to
start process B before process A is actually up and running.  Simply
starting process A is rarely sufficient &ndash; starting B too soon can
lead to B terminating prematurely because it cannot yet connect to A.</p>

<p>One may argue that B should try and reconnect, or that A and B should
have some other means of synchronizing.  Sure, when dependencies are
clear and developers create cooperating services this works great.  But
this is rarely the case in real life.  Services are usually developed by
multiple teams, scattered across both time and distance.  So what we&rsquo;re
left with is finding the least common denominator and use that for our
synchronization needs.</p>

<p>Waiting for daemon A to create its PID file before we start process B is
enough.  When the system is reconfigured &ndash; many services may need to be
restarted &ndash; we can shake the dependency tree and send <code>SIGHUP</code> to all
daemons in the correct order.  The only patching required is to ensure
that all daemons re-assert their PID files after having reloaded their
respective config files.</p>

<p>More on the changes in Finit3 and the upcoming new dependency systems
in a later article.  Hopefully this will have made you interested!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/04/04/lecture-from-the-unix-beards/">Lecture From the UNIX Beards</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-04-04T00:14:28+02:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>4</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:14 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After the <code>rm -rf /*</code> disaster that hit me a couple of weeks ago I&rsquo;ve
been rebuilding my setup, restoring the few files I&rsquo;ve had backed up,
and collecting advice from the elders.</p>

<p>Turns out there are a few tricks that can save your home directory from
accidents like mine.  The first one is rather obvious, but I&rsquo;m writing
it down anyway:</p>

<ol>
<li>Keep separate accounts.  If possible, use separate accounts (with
different permissions obviously) for different projects.  I had my
private life and work life mixed up, so that&rsquo;s a big no-no to begin
with.</li>
<li>Create a file called <code>-t</code> in your <code>$HOME</code></li>
</ol>


<p>The last bit of advice I&rsquo;d heard about earlier, about ten years earlier,
but completely forgotten about.  The trick is to create a file that will
be interpreted by <code>rm</code> as an unknown option.  For GNU <code>rm</code> the <code>-t</code> is a
good choice.</p>

<p>Here are two ways of creating such a file:</p>

<pre><code>cd
touch ./-t
</code></pre>

<p>or, the perhaps easier to remember:</p>

<pre><code>touch -- -t
</code></pre>

<p>Cheers!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/03/24/disaster-recovery/">Disaster Recovery</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-24T22:39:00+01:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>24</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:39 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Days like these inconspicuously start out just like any other day,
except on days like these you accidentally manage to erase <code>$HOME</code> and
have no real backup to rely on &hellip; Maundy Thursday will forever be Black
Thursday for me, from now on.</p>

<p>Best thing your can do, after cursing at yourself constantly for a
couple of hours, is to:</p>

<ol>
<li>Come up with a useful backup and <em>restore</em> strategy</li>
<li>Read up on undeletion tools for Ext4</li>
<li>Blog about it, naturally</li>
</ol>


<p>BUT FIRST &ndash; QUICK &ndash; UNMOUNT OR POWER-OFF YOUR COMPUTER &ndash; PULL OUT THE
BATTERY &ndash; AND STEP AWAY FROM THE COMPUTER!  Must protect the partition
from being accidentally written to &ndash; I completely fumbled this step, so
take heed young people!</p>

<p>Now calm down and act like an engineer again.</p>

<p>There exist two neat tools, three if you count the more hard core
<code>debugfs</code>:</p>

<ul>
<li><a href="http://extundelete.sourceforge.net/">extundelete</a></li>
<li><a href="http://ext4magic.sourceforge.net/ext4magic_en.html">ext4magic</a></li>
</ul>


<p>Both have been around a while, and both are capable of restoring all
files.  See their respective home pages for details.</p>

<p>My system used LVM, of course, to make things a bit harder.  That&rsquo;s why
I&rsquo;m documenting my steps here:</p>

<ol>
<li>Remove disk from lappy</li>
<li>Prepare to connect using USB cradle to workstation, <em>prepare</em> don&rsquo;t
do it yet!  I did the next few steps as root on my workstation,
that&rsquo;s right, I didn&rsquo;t care anymore at this point.  The world may as
well burn!</li>
<li>You haven&rsquo;t connected the disk yet, right stupid?  Most systems today
have cool features like automount that would cause the journal to be
replayed &ndash; WE DO NOT WANT THAT OK? OK!</li>
</ol>


<p>You need the lvm tools:</p>

<pre><code>apt-get install lvm2
vgscan
vgchange -ay ubuntu-vg
lvs
</code></pre>

<p>The last command should list your logical volume group(s), in my case
labled <code>ubuntu-vg</code>.  To be able to run <code>extundelete</code> or <code>ext4magic</code> on
the partition you have to mount the partition, <em>read-only</em> needless to
say:</p>

<pre><code>mkdir /rescue
mount -o ro /dev/ubuntu-vg/root /rescue
</code></pre>

<p>Now we try some fairy dust:</p>

<pre><code>ext4magic /dev/ubuntu-vg/root -r
</code></pre>

<p>OK, so let&rsquo;s see:</p>

<pre><code>ls -l RECOVERDIR/
</code></pre>

<p>The results between <code>ext4magic</code> and <code>extundelete</code> may vary, so try them
both out, test different options, and maybe even look at <code>debugfs</code>,
we&rsquo;re desperate after all.</p>

<pre><code>extundelete /dev/ubuntu-vg/root --restore-all
ls -l RECOVERED_FILES
</code></pre>

<p>If there&rsquo;s a LOT of files you may have some luck narrowing down the
result using the <code>--after DATE</code> option &hellip; where <code>DATE</code> is the number
of seconds since the UNX epoch:</p>

<pre><code>extundelete /dev/ubuntu-vg/root --restore-all --after 1458802800
ls -l RECOVERED_FILES
</code></pre>

<p>I found my magic number using</p>

<pre><code>date -d "Mar 24 8:00 2016" +%s
</code></pre>

<p>Well, as I said, I didn&rsquo;t turn off my computer in time. Instead I took
the braindead option of starting to google for solutions.  So all my
files (with proper filenames) turned out to contain only cached files
from the browser &ndash; reclaiming the blocks goes quick, so watch out kids.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/03/07/testing-multicast-with-docker/">Testing Multicast With Docker</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-07T01:37:04+01:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:37 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently <a href="https://github.com/troglobit/pimd/issues/70">issue #70</a> was
reported to <a href="https://github.com/troglobit/pimd/">pimd</a>.  That number of
issues reported is cool in itself, but this was a question about
<a href="https://www.docker.com">Docker</a> and <code>pimd</code>.</p>

<p>Up until that point I had only read about this new fad, and played
around with it a bit <a href="http://www.westermo.com">at work</a> for use as a
stable build environment for cross-compiling.  I had no idea people
would want to use a Docker container as a multicast sink.  Basically I
was baffled.</p>

<p>The reporter used a Java based tool but simply couldn&rsquo;t get things to
work properly with <code>pimd</code> running on the host:</p>

<pre><code>                eth0
 MC sender ---&gt; [ Server host ]    &lt;--- router running pimd
                       |
               ________|________
              /     docker0     \   &lt;--- bridge    ______
             /         |         \                |      |   &lt;--- MC receiver
  __________/          |          \_______________|______|_____
 \                     |                            /         /
  \                     `------------------&gt;-------'         /
   \________________________________________________________/
      Container ship
</code></pre>

<p>We tried several approaches, but nothing seemed to help.  This became a
bit of blocker for the <code>pimd</code> v2.3.2 release and I admittedly lost a bit
of sleep over this.  So finally this weekend, I sat down and whipped my
old <a href="https://github.com/troglobit/mcjoin/">mcjoin</a> tool up into shape.
I&rsquo;ve relied on it for years, but it couldn&rsquo;t send or receive packets,
until now.</p>

<p>Running docker v1.5 in Ubuntu 15.10 I ran this, with <code>pimd</code> on the host
and <code>mcjoin</code> as a multicast sink for 250 groups in a container:</p>

<pre><code>cd ~/Troglobit/mcjoin
docker run -t -i -u `id -u`:`id -g` -v $HOME:$HOME -w $PWD troglobit/toolchain:latest ./mcjoin 225.1.2.3+250
^C
Received total: 2500 packets
</code></pre>

<p>The <code>pimd</code> and the multicast sender runs on my host, which should not
matter since Linux still has to route the traffic to the <code>docker0</code>
interface.  Also, without setting the TTL to 2 (or greater) the
container receives no traffic at all.  Here&rsquo;s what I run in another
terminal on my host:</p>

<pre><code>./mcjoin -s -t 2 -c 10 225.1.2.3+250
</code></pre>

<p>Although <code>pimd</code> is a little slow to register and install the forwarding
rules in the kernel, it sure enough worked on the first attempt! \o/</p>

<p>This is my first real application level experience with Docker, but it
is sure not the last.  Docker is a truly revolutionary new tool!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/03/07/multicast-testing/">Multicast Testing, Made Easy!</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-07T01:06:02+01:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>1:06 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For the better part of the last ten years I&rsquo;ve been working with
multicast in one way or another.  I&rsquo;ve used many different tools for
testing, but usually simply using <code>ping(1)</code> and <code>tcpdump(1)</code> is quite
sufficient.  However, you often need to tell bridges (switches) to open
up multicast in your general direction for your pings to get through, so
you need to send an IGMP &ldquo;join&rdquo; first.  I found mcjoin, written by David
Stevens, in <a href="https://lkml.org/lkml/2004/8/5/143">this posting to LKML</a>
back in 2006, and started improving it and adding features to it over
the years.</p>

<p>Now, my interest and fascination with multicast only grew with time,
and despite elegant tools like <code>mgen(1)</code> and <code>omping(1)</code> I was never
quite happy.</p>

<p>When releasing SMCRoute v2.1.0 recently, and currently working on the
pimd v2.3.2 release, I was so tired of having to do so many manual steps
just to verify correct operation of a routing daemon.  Therefore I spent
the better part of the weekend fixing up my old mcjoin tool.</p>

<p>I wanted a reliable, simple, and UNIX-y tool to just test things for me.
So I cleaned up the old mcjoin project, first by migrating it from the
toolbox repo, then remove confusing command line options, improve and
simplify the syntax, and then added send/receive capabilities.  Been
meaning to get around to this for ages, and now it seems I had finally
had enough.  So here it is, v2.0:</p>

<ul>
<li><strong>Project</strong>: <a href="https://github.com/troglobit/mcjoin/">https://github.com/troglobit/mcjoin/</a></li>
<li><strong>ChangeLog</strong>: <a href="https://github.com/troglobit/mcjoin/releases/tag/v2.0">https://github.com/troglobit/mcjoin/releases/tag/v2.0</a></li>
</ul>


<p>Most of the time I simply want to see a resulting IGMP join message in
Wireshark, see it bite in a switch&rsquo;s FDB or a routing daemon&rsquo;s
forwarding table.  So, join is the default operation, and also continues
to be the name of the tool.  My favourite testing group is set as the
default, 225.1.2.3, so you only need to start the tool and you&rsquo;re off.
To send to the same default group (225.1.2.3), simply add <code>-s</code> to the
sender side.</p>

<pre><code>sender$ mcjoin -s
^C
sender$

receiver$ mcjoin
joined group 225.1.2.3 on eth0 ...
..................................................................^C
Received total: 66 packets
receiver$
</code></pre>

<p>If you ever need anything else, e.g. routing multicast, there&rsquo;s even a
man page.  It mentions setting the TTL and other such nastiness :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/14/useful-unix-api-s/">Useful UNIX API:s</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-14T11:45:49+01:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:45 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Had an interesting conversation with a buddy last night.  It started out
as a shift-reduce problem with Bison and ended up a ping-pong of useful
UNIX API:s.  We concluded that despite having worked professionally with
UNIX for over a decade, it is still very satisfying finding gems like
these.</p>

<p>Most people are completely unaware they exist and end up rolling their
own (buggy) implementations.</p>

<h2>SysV <code>search.h</code></h2>

<p>Mangage a <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/insque.html">simple queue</a>:</p>

<ul>
<li><code>insque()</code></li>
<li><code>remque()</code></li>
</ul>


<p>Manage <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/hcreate.html">hash search table</a>:</p>

<ul>
<li><code>hsearch()</code></li>
<li><code>hcreate()</code></li>
<li><code>hdestroy()</code></li>
</ul>


<p>Manage a <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/tsearch.html">binary search tree</a>:</p>

<ul>
<li><code>tsearch()</code></li>
<li><code>tfind()</code></li>
<li><code>tdelete()</code></li>
<li><code>twalk()</code></li>
<li><code>tdestroy()</code></li>
</ul>


<p><a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/lsearch.html">Linear search</a> and update:</p>

<ul>
<li><code>lfind()</code></li>
<li><code>lsearch()</code></li>
</ul>


<h2>BSD <code>sys/queue.h</code></h2>

<p><a href="https://www.freebsd.org/cgi/man.cgi?query=queue&amp;sektion=3">This header</a> has lots of macros for handling various forms of
linked lists.  The version in GLIBC is a bit behind the BSD&rsquo;s, because
the latter also have <code>_safe()</code> versions of some macros to aid the user
in some tricky cases, e.g. when removing entries while iterating.</p>

<p>Several types of lists are supported:</p>

<ul>
<li>LIST: Doubly linked list</li>
<li>SLIST: Single linked list</li>
<li>STAILQ: Single linked tail queue</li>
<li>SIMPLEQ: Simple queue</li>
<li>TAILQ: Tail queue</li>
</ul>


<p>Here&rsquo;s a few of them, this example for doubly linked lists:</p>

<ul>
<li><code>LIST_INIT()</code></li>
<li><code>LIST_EMPTY()</code></li>
<li><code>LIST_FIRST()</code></li>
<li><code>LIST_NEXT()</code></li>
<li><code>LIST_REMOVE()</code></li>
<li><code>LIST_FOREACH()</code></li>
<li><code>LIST_INSERT_AFTER()</code></li>
<li><code>LIST_INSERT_BEFORE()</code></li>
<li><code>LIST_INSERT_HEAD()</code></li>
</ul>


<p>I wrote a <a href="https://github.com/troglobit/toolbox/blob/master/tailq-demo.c">demo of the TAILQ API</a> a couple of years ago.</p>

<h2>Other Noteworthy API&rsquo;s</h2>

<p>Other functions worthy of mentioning here are:</p>

<h3><code>stdlib.h</code></h3>

<ul>
<li><code>bsearch()</code></li>
<li><code>qsort()</code></li>
</ul>


<h3><code>glob.h</code></h3>

<ul>
<li><code>glob()</code></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/13/en-vanlig-dag-pa-jobbet-swedish/">En Vanlig Dag På Jobbet (SWEDISH)</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-13T20:57:29+01:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>8:57 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I vanlig ordning bashar vi DNS på jobbet, pga ofungerar <em>hårt</em> över VPN
för de flesta. (Ja vi kör alla Linux, utom cheferna som envisas med att
använda något ur gamla testamentet.) Här följer ett utdrag från vår IRC:</p>

<pre><code>14:32 &lt;n00b&gt; Success! Äntligen fick jag ordning på DNS via guest
      wifi -&gt; vpn -&gt; office network. Firar med att skapa lite irc noise. :D
14:32 &lt; rooth&gt;n00b: Du har väl fått den distribuerade /etc/hosts filen?
14:33 &lt; rooth&gt; !dns paperboy
14:33 &lt; |master|&gt; rooth: server028.intranet.example.com. 192.168.130.72 lazyboy lazyboy.intranet.example.com
14:33 &lt; rbot&gt; rooth: lazyboy: 192.168.130.72
14:33 &lt; rooth&gt; bottarna hjälper dig annars =)
14:34 &lt;n00b&gt; hosts file is so... "unclean" ;)
14:35 &lt;n00b&gt; Men bra att veta att bottar kan hjälpa. :)
14:37 &lt; rooth&gt;n00b: Förstår inte alls vad du menar... =)
14:37 &lt; rooth&gt;n00b: Det finns två skolor på bygget, dns vs hosts.
14:38 &lt;n00b&gt; Oh! Så jag har tydligen valt sida nu då. :D
14:40 &lt; rooth&gt;n00b: dns = dark-side.
14:50 &lt; lazzer&gt;n00b: ;-)
14:52 &lt; rooth&gt;n00b: s#local dns cache#/etc/hosts# =)
14:52 &lt; moggen&gt; hehe HOSTS.TXT revival
14:52 &lt; moggen&gt; var så det började en gång i tiden
14:52 &lt; moggen&gt; innan man uppfann DNS
14:53 &lt; lazzer&gt; Vi måste komma på ett bra system för att dela våra hosts-filer.
14:53 &lt;n00b&gt; A long time ago, in a network far far away...
14:53 &lt;n00b&gt; git repo for shared hosts fil, annan conf?
14:57 &lt;n00b&gt; Finns det någon slags share-mekanism vad gäller grundläggande test
             setup btw? Eller är det för svårt att få till generell grund conf
             för lokal test setup?
15:38 &lt; troglobit&gt; Åh, har ni öppnat DNS-lådan! LOL =)
15:38  * troglobit kör med hosts-fil, såklart ;)
15:40 &lt; lazzer&gt; troglobit: bra val ;-=
15:44 &lt; rooth&gt; troglobit: Jag tyckte det var dags =)
16:00 &lt; moggen&gt; troglobit: upptäckte när jag jobbade hemma att man får "fel" IP på
                web.example.com om man inte sitter på kontors-IP... hosts ftw.
16:22 &lt; troglobit&gt; moggen: Härligt att se att du sållat dig till den enda sanna läran ;)
16:59 &lt; rooth&gt; =)
17:06 &lt; wkz&gt; moggen,troglobit : another one bites the dust... :)
18:12 &lt; n00b2&gt; Helgen är räddad vpn-dosan återfunnen
20:19 &lt; troglobit&gt; wkz: DNS är en kvarleva av ett döende system. Kom, anslut dig
               till oss istället, vi kämpar för rättvisa, säkerhet, och fria
               statiska /etc/hosts-uppdateringar i galaxen!
20:19 &lt; wkz&gt; troglobit: NEVER!
20:20 &lt; troglobit&gt; wkz: *Feel* the power of the dark side!
20:20 &lt; wkz&gt; troglobit: LOL
20:20 &lt; troglobit&gt; wkz: :-D
</code></pre>

<p>Some names have been changed to protect the innocent, the rest are Sith
Lords or Jedi Knights.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/10/awesome-changing-next-slash-prev-tune-in-spotify/">Awesome: Changing Next/Prev Tune in Spotify</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-10T12:14:09+01:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:14 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Back to using the <a href="http://awesome.naquadah.org/">Awesome WM</a> in Ubuntu.
This time I&rsquo;m setting up everything from scratch and first up is fixing
keybindings to control my main music player: Spotify!</p>

<p>Edit your <code>~/.config/awesome/rc.lua</code> with Emacs (obviously).  If you do
not have an rc file, simply copy the system <code>/etc/xdb/awesome/rc.lua</code>:</p>

<pre><code>globalkeys = awful.util.table.join(globalkeys,
           awful.key({}, "XF86AudioRaiseVolume", function () awful.util.spawn("amixer -D pulse sset Master 5%+", false) end),
       awful.key({}, "XF86AudioLowerVolume", function () awful.util.spawn("amixer -D pulse sset Master 5%-", false) end),
       awful.key({}, "XF86AudioMute", function() awful.util.spawn('amixer -D pulse sset Master 1+ toggle') end),
       awful.key({ }, "XF86AudioNext", function () awful.util.spawn("dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.Next")end),
       awful.key({ }, "XF86AudioPrev", function () awful.util.spawn("dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.Previous")end),
       awful.key({ }, "XF86AudioPlay", function () awful.util.spawn("dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.PlayPause")end),
       awful.key({ }, "XF86AudioStop", function () awful.util.spawn("dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.Stop")end))
root.keys(globalkeys)
</code></pre>

<p>That&rsquo;s it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/11/07/stray-puppies/">Stray Puppies</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-11-07T02:32:12+01:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>2:32 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sometimes I just cannot help myself.  It&rsquo;s like finding a stray puppy,
or abandonded kitten &hellip;</p>

<p>&hellip; I recently decided to adopt <a href="/mini-snmpd.html">mini-snmpd</a> since the
<a href="http://members.aon.at/linuxfreak/linux/mini_snmpd.html">original upstream</a> site had passed into the great beyond.  At this
point in my life almost everyone I know can tell you I have no warm
fuzzy feels for SNMP, at all.  So why did I even consider this to begin
with?!</p>

<p>Well, I have to confess that there are certain things that SNMP can be
really useful for.  Most of it is remote monitoring, and since I work
with embedded systems a lot, SNMP can be quite a handy tool.</p>

<p>I first ran into mini-snmpd when I created <a href="https://github.com/troglobit/troglos">TroglOS</a>, by forking
<a href="https://github.com/hno/miniroot">miniroot</a>, and what struck me immediately was how small and simple
it was.  The code was also in reasonably good shape, so it had passed my
initial quality control.  Suddenly one day I could no longer download it
when building TroglOS, so I had to do something!</p>

<p>My plans for mini-snmpd are quite humble.  I&rsquo;m currently cleaning it up
a bit, adding configure script for all optional features, testing
portability to FreeBSD and <a href="https://github.com/javiplx/mini-snmpd">integrating (good) patches</a> from various
sources scattered around the web.</p>

<p>I will not add lots of new features, but as always I&rsquo;m your humble patch
monkey, so if you <a href="https://github.com/troglobit/mini-snmpd">submit a pull reqeust</a> at GitHub it&rsquo;ll probably be
merged and put into a release.</p>

<p>Cheers</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Projects</h1>
  <ul>
    <li><a href="/finit.html">Fast Init Replacement</a></li>
    <li><a href="/inadyn.html">Inadyn DDNS Client</a></li>
    <li><a href="/smcroute.html">SMCRoute Static Multicast Routing</a></li>
    <li><a href="/mrouted.html">The Original Multicast Routing Daemon</a></li>
    <li><a href="/pimd.html">The Original PIM-SM Daemon</a></li>
    <li><a href="/tetris.html">Micro Tetris&trade;</a></li>
    <li><a href="/snake.html">Micro Snake</a></li>
    <li><a href="/editline.html">Minix Editline</a></li>
    <li><a href="/mini-snmpd.html">Mini-SNMPd</a></li>
    <li><a href="/uftpd.html">Micro FTP/TFTP Daemon</a></li>
  </ul>
</section>
<section>
  <h1>HowTos</h1>
  <ul>
    <li><a href="/multicast-howto.html">Multicast</a></li>
    <li><a href="/blog/2014/09/23/howto-add-multicast-routing-support-to-the-freebsd-kernel/">MROUTING support on FreeBSD</a></li>
    <li><a href="/howto-run-pimd-on-openbsd.html">Run pimd on OpenBSD</a></li>
    <li><a href="/howto-run-pimd-on-freebsd.html">Run pimd on FreeBSD</a></li>
    <li><a href="/howto-netbsd-pkgsrc.html">Use NetBSD pre-built packages</a></li>
    <li><a href="/howto-play-with-snmp.html">Play with SNMP</a></li>
  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/04/21/using-netcat-to-test-your-internet-daemon/">Using Netcat to Test Your Internet Daemon</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/11/the-key-to-successful-boot/">The Key to Successful Boot</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/04/lecture-from-the-unix-beards/">Lecture From the UNIX Beards</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/24/disaster-recovery/">Disaster Recovery</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/07/testing-multicast-with-docker/">Testing Multicast With Docker</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/troglobit">@troglobit</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'troglobit',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Latest Tweets</h1>

  <a class="twitter-timeline" data-dnt="true"
     href="https://twitter.com/troglobit"
     data-widget-id="365667052100415488">Tweets by @troglobit</a>
  <script>!function(d,s,id){var
    js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Joachim Nilsson -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>

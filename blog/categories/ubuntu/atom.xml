<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ubuntu | Troglobit]]></title>
  <link href="http://troglobit.github.io/blog/categories/ubuntu/atom.xml" rel="self"/>
  <link href="http://troglobit.github.io/"/>
  <updated>2015-07-14T18:24:21+02:00</updated>
  <id>http://troglobit.github.io/</id>
  <author>
    <name><![CDATA[Joachim Nilsson]]></name>
    <email><![CDATA[troglobit@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[HowTo: Use Ubuntu to Serve Music to iTunes]]></title>
    <link href="http://troglobit.github.io/blog/2010/12/31/howto-setup-debian-slash-ubuntu-to-serve-music-to-itunes/"/>
    <updated>2010-12-31T19:26:37+01:00</updated>
    <id>http://troglobit.github.io/blog/2010/12/31/howto-setup-debian-slash-ubuntu-to-serve-music-to-itunes</id>
    <content type="html"><![CDATA[<p>OK, so we finally got an iPad.  The effective marketing droids of Apple
are doing a good job, even the Linux zealots are starting to use their
products :-)</p>

<p>So, how to serve the immense music collection of our family to the iPad?
Well, it seems the magic integration with iTunes is not enough (yet), so
you need a <a href="http://itunes.apple.com/app/simple-daap-client/id369605270">Simple Daap Client</a> app on your iPad to get the most out
of this HowTo. I hope DAAP sharing for iPad will be added soon, that
would be really cool!</p>

<p>I used the <a href="http://www.fireflymediaserver.org/">Firefly Media Server</a>, which in Debian/Ubuntu is known as
<a href="apt://mt-daapd">mt-daapd</a>.  It needs som minor setting up to play nice with the
Avahi multicast DNS (mDNS) services that we will use to let iTunes
discover our new service.</p>

<p>First go ahead and install mt-daapd</p>

<pre><code>sudo apt-get install mt-daapd
</code></pre>

<p>Then make sure to edit the file <code>/etc/default/mt-daapd</code> file, it usually
does not exist in the default setup, so create it and add the following
contents to disable the built-in mDNS server:</p>

<pre><code># -m Disables the built-in mDNS server, useful if you already run Avahi
DAEMON_OPTS="-m"
</code></pre>

<p>The default configuration of must be updated with the location of your
music library.  On my system it is <code>/pub/Music</code>, so I edit the file
<code>/etc/mt-daapd.conf</code> and change:</p>

<pre><code># Location of the mp3 files to share.  Note that because the
# files are stored in the database by inode, these must be
# in the same physical filesystem.
mp3_dir = /pub/Music
</code></pre>

<p>If you like, you can change the <code>admin_pw</code> (mt-daapd) and default port
to something other than the defaults.  After changing the settings you
need to restart the service:</p>

<pre><code>sudo service mt-daapd restart
</code></pre>

<p>Now enter <code>localhost:3689</code> in your browser window, leave the username
field empty and set password to mt-daapd.  Unless you changed any of the
defaults above.</p>

<p>Time for multicast!  The Avahi service on GNU/Linux systems is what
Bonjour/Rendez-Vous is to Apple systems.  It provides seamless
interaction between clients and servers on a LAN.  My HP printer, for
instance, pops up automatically in Windows, OS X and Linux these days
because these operating systems listen in on network mDNS servers that
broadcast (or rather multicast) available services.  Very neat.</p>

<p>However, as usual there are a few snags you might need to work around to
get everything to work.  Thanks to my ISP (Telia, Sweden), I need to tell
Avahi the following nasty things in <code>/etc/default/avahi-daemon</code></p>

<pre><code># 1 = Try to detect unicast dns servers that serve .local and disable avahi in
# that case, 0 = Don't try to detect .local unicast dns servers, can cause
# troubles on misconfigured networks
AVAHI_DAEMON_DETECT_LOCAL=0
</code></pre>

<p>And also edit the file <code>/etc/avahi/avahi-daemon.conf</code>, the following is
not the entire contents of the file, only the sections I&rsquo;ve changed:</p>

<pre><code>[server]
# Comment out any current/previous work arounds
#domain-name=local
#domain-name=.alocal
disallow-other-stacks=yes

[publish]
publish-workstation=no
publish-domain=no
</code></pre>

<p>Also, in the directory <code>/etc/avahi/services/</code> we need to add an entry for
DAAP.  Create the file <code>/etc/avahi/services/daap.service</code>:</p>

<pre><code>&lt;!DOCTYPE service-group SYSTEM "avahi-service.dtd"&gt;
&lt;!-- iTunes DAAP, music streaming, for mt-daapd or Firefly Media Server
     See avahi.service(5) for more information about this configuration file --&gt;

&lt;service-group&gt;
    &lt;name replace-wildcards="yes"&gt;%h&lt;/name&gt;

    &lt;service&gt;
        &lt;type&gt;_daap._tcp&lt;/type&gt;
        &lt;port&gt;3689&lt;/port&gt;
        &lt;txt-record&gt;txtvers=1&lt;/txt-record&gt;
        &lt;txt-record&gt;iTSh Version=131073&lt;/txt-record&gt;
        &lt;txt-record&gt;Version=196610&lt;/txt-record&gt;
    &lt;/service&gt;

    &lt;service&gt;
        &lt;type&gt;_rsp._tcp&lt;/type&gt;
        &lt;port&gt;3689&lt;/port&gt;
    &lt;/service&gt;
&lt;/service-group&gt;
</code></pre>

<p>Now, restart avahi and see your music server pop up automatically as a
Share in iTunes:</p>

<pre><code>sudo service avahi-daemon restart
</code></pre>

<p>Good Luck!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HowTo: Move Window Buttons Back to the Right]]></title>
    <link href="http://troglobit.github.io/blog/2010/05/01/howto-move-window-buttons-back-to-the-right-hand-side/"/>
    <updated>2010-05-01T16:46:57+02:00</updated>
    <id>http://troglobit.github.io/blog/2010/05/01/howto-move-window-buttons-back-to-the-right-hand-side</id>
    <content type="html"><![CDATA[<p>When you&rsquo;ve installed Ubuntu 10.04 you might want to have the window
controls back to the right side, where you&rsquo;re used to having them.  Use
the following simple command:</p>

<pre><code>gconftool-2 --set /apps/metacity/general/button_layout --type string "menu:minimize,maximize,close"
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ubuntu 8.10rc1 &mdash; NetworkManager WTF?!]]></title>
    <link href="http://troglobit.github.io/blog/2008/10/27/ubuntu-8-dot-10rc1-networkmanager-wtf/"/>
    <updated>2008-10-27T18:50:03+01:00</updated>
    <id>http://troglobit.github.io/blog/2008/10/27/ubuntu-8-dot-10rc1-networkmanager-wtf</id>
    <content type="html"><![CDATA[<p>I tried upgrading from Hardy Heron to Intrepid Ibex this weekend.  Big
mistake.  If I disregard the total dpkg meltdown that I, as usually, had
to resolve manually there still remains this recurring madness called
Network Manager.</p>

<p>I&rsquo;m an engineer.  I have a masters degree in computer engineering.  I
have worked professionally with GNU/Linux since 2000 and been a die hard
user of it since I left OS/2 behind in 1996.  But come on!  Why does it
take a software engineer to perform a simple upgrade?  Even worse, why
do I have to be a network engineering specialist to figure out why
simple wired ethernet doesn&rsquo;t work out of the box?</p>

<p>Network Manager fails completely to:</p>

<ol>
<li>Select wired network over an open Telia hotspot</li>
<li>Distinguish between my primary and secondary wired interfaces</li>
<li>Completely loses my <code>/etc/resolv.conf</code> all the time</li>
</ol>


<p>Sorry, but that is completely inexcusable!  <a href="http://www.gnome.org/projects/NetworkManager/">Network Manager</a>, you
suck!  &ldquo;Pain-Free Networking&rdquo;, my ass! :-P</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Suspend/Resume Nightmare in Ubuntu]]></title>
    <link href="http://troglobit.github.io/blog/2008/02/23/suspend-slash-resume-nightmare-in-ubuntu/"/>
    <updated>2008-02-23T20:34:44+01:00</updated>
    <id>http://troglobit.github.io/blog/2008/02/23/suspend-slash-resume-nightmare-in-ubuntu</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve had my ThinkPad T43 for a while now and I&rsquo;m really pleased with it,
everything just works!  It took some pleading and, I admit, begging to
persuade my boss and the IT department to buy it since they usually only
buy from Dell or HP.  This was mainly due to care packs and payment plans
that these suppliers offer companies.  My ThinkPad they had to actually
pay for straight up.  So if I were a Lenovo sales person, that was
something I would fix to boost my sales.</p>

<p>This post is however not about sales, brands of laptops or how the cat
ate my homework &hellip; well, OK, almost.  Ubuntu/Gnome ate my resume!</p>

<p>When I initially installed the laptop, early 2006, I went with
Ubuntu 5.10.  Ubuntu is great Linux dist!  Ubuntu is to Debian what
Mandrake was to RedHat in the beginning: RedHat + all the tweaks you
usually had to apply.</p>

<p>I remember the first install, it was a Breeze!  All features and extras
of the laptop was of course not working.  After some digging I found a
few pages detailing what to do to get things like susped, hibernate and
such working.  A couple of hours later everything was working!  Cool,
that had to be the first computer where I actually bothered setting it
all up.</p>

<p>Now, two years later I run 7.10 and I am less than happy.  All upgrades
have made this laptop a complete mess.  Each upgrade has failed to
integrate the necessary changes I made and simply installed the new
default settings from each package.  OK, I can live with that.  But I was
starting to really miss having no suspend, so the last four months I
have been working on fixing it all again.</p>

<p>It turns out that if I run the script <code>/etc/acpi/suspend.sh</code> manually
from the prompt suspend and resume works fine, even with X.  But when I
press Fn-F4 from within X or select &ldquo;Suspend&rdquo; from the Gnome &ldquo;logout&rdquo;
menu the machine happily goes to sleep but always fails at resume.  I
always get a black screen!</p>

<p>Why is it so complicated?  I really don&rsquo;t understand.  What is it doing?</p>

<p>OK, so I started digging.  The Fn-F4 button didn&rsquo;t work in the console
so that seemed like a first thing to investigate.  I started
<code>acpi_listen</code> and pressed Fn-F4, bingo!  It returned a key press.  A
grep later and I had found it in <code>/etc/acpi/events/ibm-sleepbtn</code>,
alright!  Simple syntax, seems it looks for the ThinkPad sleep button
and then sends another new combination <code>$KEY_SLEEP</code>, wtf?</p>

<p>I changed the action to call <code>/etc/acpi/sleep.sh</code>, restarted the ACPI
stuff and, yes it works!  At least from the console, not from X/Gnome.
Aha, so we have a Gnome app that does magic things, HAL +
gnome-power-manager.</p>

<p>I didn&rsquo;t get any further.  Removing gnome-power-manager fixed my
problem, I can now press Fn-F4 from Gnome, close the lid, come back the
next morning and sucessfully resume when opening the lid again.</p>

<p>So, the question is, wtf is gnome-power-manager doing and why do I have
to learn this stuff all over again every time I upgrade?</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Netapplet Patchwork]]></title>
    <link href="http://troglobit.github.io/blog/2007/07/12/netapplet-patchwork/"/>
    <updated>2007-07-12T11:37:38+02:00</updated>
    <id>http://troglobit.github.io/blog/2007/07/12/netapplet-patchwork</id>
    <content type="html"><![CDATA[<p>I think I&rsquo;ve finally done it &mdash; achieved my ultimate goal of
combining the awesome powers of the Debian <code>/etc/network/interfaces</code>
file with <code>guessnet</code>, <code>wpa_supplicant</code>, <code>ifplugd</code> and now also with
netapplet!</p>

<p>I&rsquo;ve been looking for a way to just point-and-click to select a
different access point, both at home and at work.  To that end I have a
pretty advanced interfaces file that automatically detects where I am,
what I am connected with (cable/wireless) and then, like magic, sets it
all up.</p>

<p>Several times now I have tried, really hard, to get used to and live my
life with <a href="http://www.gnome.org/projects/NetworkManager/">Network Manager</a>, but it&rsquo;s just plain impossible.  It
still doesn&rsquo;t integrate well with Debian ifupdown et consortes and until
now I&rsquo;ve been using <code>ifup</code> to select different wireless mappings:</p>

<pre><code>$ sudo ifdown eth2; sudo ifup eth2=WLAN
Password: ***********
[Use crappy work AP to access VPN tunnel]
$ sudo ifdown eth2; sudo ifup eth2=NETLET
Password: ***********
[Use family WRT54GL access point]
</code></pre>

<p>For the last couple of days I&rsquo;ve been looking into getting the old
(obsoleted?) Netapplet from Novell.  Since I&rsquo;m a Ubuntu user I&rsquo;m using
the Debian patched-up version by <a href="http://mjg59.livejournal.com/">Matthew Garrett</a> (thanks!).  I
remember using it a couple of years back, at that time I think it worked
but now it didn&rsquo;t &mdash; not well at least.  I found several bugs and
quirks that I have now fixed and published in my own &ldquo;repository&rdquo;.</p>

<p>I have published everything as a Bazaar branch, one changeset per patch
(small patches), at <a href="https://web.archive.org/web/20090528101921/http://vmlinux.org/jocke/bzr/netapplet-1.0.8/">http://vmlinux.org/jocke/bzr/netapplet-1.0.8</a>,
which can be viewed <a href="https://web.archive.org/web/20090528101921/http://vmlinux.org/jocke/bzr/">here</a> using bzrweb.</p>
]]></content>
  </entry>
  
</feed>
